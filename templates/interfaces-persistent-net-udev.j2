{% for interface in ansible_interfaces|sort %}
{% set iface = ansible_facts[interface] %}
{% if (system_network_sriov_pf[interface]|default(false)) and iface.type is defined and iface.type == "ether" and iface.pciid is defined and not(iface.module in system_network_sriov_vf) %}
{% if not iface.module in ['cdc_ether'] %}
# Pin network interface {{ iface.pciid }}/{{ iface.perm_macaddress | default(iface.macaddress) }} -> {{ interface }}
SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="{{ iface.perm_macaddress | default(iface.macaddress) }}", ATTR{dev_id}=="0x0", ATTR{type}=="1", KERNEL=="eth*", NAME="{{ interface }}"
{% endif %}{% endif %}
{% endfor %}
